<section class="menu" ng-controller="MenuController" ng-init="init()">
  <div class="top-header">
    <h2>The Pelican Blog</h2>
  </div>
  <div class="body">
    <% if (user) { %>
    <div class="user" send-to="/user/<%= user._id %>">
      <% if (user.image) { %>
        <img src="<%= user.image %>" alt="<%= user.displayName %>" />
      <% } %>
      <%= user.givenName + "'s Pelican" %>
    </div>

    <div class="relative">
      <input type="text" ng-model="query" placeholder="Search your pelican..." escape-search/>
      <div class="icon ion-ios-search-strong" ng-show="!query"></div>
      <div class="icon ion-android-close" ng-click="query = ''" ng-show="query" ng-cloak></div>
    </div>
    <% } else { %>
      <div class="auth">
        <button type="button" send-to="/auth/facebook">Sign Up / Login</button>
      </div>
    <% } %>

    <% if (user && user._id) { %>
    <div class="list menu-list discover" identify-location="/discover">
      <div class="p-wrapper" send-to="/discover">
        <span class="icon ion-ios-navigate-outline hashtag"></span>
        <p class="p-title">discover</p>
      </div>
      <hr />
    </div>
    <% } %>

    <div class="list menu-list"
         ng-click="makeActive(list)"
         id="menu-list-{{list._id}}"
         identify-location="/list/{{list._id}}"
         ng-repeat="list in lists | menuSearch:query"
         menu-helper ng-cloak>
      <div class="p-wrapper">
        <p class="hashtag">#</p>
        <p class="p-title" ng-bind-html="sanitizeHtml(list.title)"></p>
        <span class="icon ion-ios-locked-outline" ng-if="list.isPrivate"></span>
      </div>
      <hr ng-show="query || list.displayPosts" identify-location="/list/{{list._id}}"/>
      <div class="posts" ng-show="query || list.displayPosts">
        <div class="post animated-fast fadeInLeft"
            ng-repeat="post in list.posts" search-post
            ng-click="openPostMenu(post, $index, $parent.$index)">
          <p class="post-title" ng-bind-html="sanitizeHtml(post.title)"></p>
        </div>
      </div>
    </div>
  </div>

  <% if (owner) { %>
    <% include ./menu-small.ejs %>
  <% } %>
</section>
