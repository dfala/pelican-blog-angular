angular.module("Pelican",["ngSanitize"]),angular.module("Pelican").controller("BannerController",["$scope","apiService","validator","$rootScope",function(a,b,c,d){a.init=function(b,c){b&&(a.user=b),c&&(a.lists=c)},a.closeListModal=function(){a.isListModalOpen=!1,a.activeList=null,a.listTitle="",a.newPost={}},a.addList=function(c){return c?void b.addList(c).then(function(b){alertify.success("New list created!"),a.activateList(b.data),a.lists.push(b.data)}).catch(function(a){console.error(a),alertify.error("Could not save your new list :(")}):alertify.error("Please add a list title to create one.")},a.activateList=function(b){a.activeList=b},a.addPost=function(e){try{c.validateNewPost(a.activeList,e)}catch(a){return alertify.error(a)}b.addPost(e,a.activeList).then(function(b){a.closeListModal(),d.$emit("new post created",b.data),alertify.success("New post created!")}).catch(function(a){console.error(a),alertify.error("Could not save your post :(")})}}]),angular.module("Pelican").controller("HomeController",["$scope","$rootScope",function(a,b){a.init=function(b,c){a.user=b||null,a.posts=c||[],console.warn(arguments)},b.$on("new post created",function(b,c){a.posts.unshift(c)}),a.openPost=function(b){a.activePost=b},a.closePostModal=function(){a.activePost=null}}]),angular.module("Pelican").controller("ListsController",["$scope","apiService","validator","$rootScope",function(a,b,c,d){a.init=function(b,c){b&&(a.user=b),c&&(a.lists=c)},a.openPost=function(b,c,d){a.activePost=b,a.activePost.postIndex=c,a.activePost.listIndex=d},a.closePostModal=function(){a.activePost=null},a.turnOffEditPost=function(){a.editingPost=!1},a.turnOnEditPost=function(){a.editablePost=angular.copy(a.activePost),a.editingPost=!0},a.updatePost=function(c){b.updatePost(c).then(function(b){a.activePost=b.data,a.editingPost=!1,d.$emit("post edited",a.activePost),a.lists[a.activePost.listIndex].posts[a.activePost.postIndex]=b.data,socket.emit("updated post","hello world!")}).catch(function(a){console.error(a),alertify.error("Were not able to update post :(")})}}]),angular.module("Pelican").controller("MenuController",["$scope","$sce","$rootScope",function(a,b,c){a.init=function(b,c){a.user=b,a.lists=c},c.$on("post edited",function(b,c){a.lists[c.listIndex].posts[c.postIndex]=c}),a.makeActive=function(b){a.lists=a.lists.map(function(a){return a.displayPosts=!1,a}),b.displayPosts=!0},a.sanitizeHtml=function(a){return b.trustAsHtml(a)}}]),angular.module("Pelican").factory("apiService",["$http",function(a){var b={};return b.addList=function(b){return a.post("/api/list",{title:b})},b.addPost=function(b,c){var d=b;return d.parentList=c._id,console.warn(d),a.post("/api/post",d)},b.updatePost=function(b){return a.put("/api/post/"+b._id,b)},b}]),angular.module("Pelican").factory("validator",[function(){var a={};return a.validateNewPost=function(a,b){if(!a)throw"Please choose a list before trying to save a new post.";if(!b||!b.title)throw"Please add a name to your post"},a}]),angular.module("Pelican").directive("sendTo",[function(){return{restrict:"A",link:function(a,b,c){b.bind("click",function(a){c.sendTo&&(window.location=c.sendTo)})}}}]).directive("menuHelper",[function(){return{restrict:"A",link:function(a,b,c){var d="#"+c.id.split("menu-")[1];b.bind("click",function(a){$(".menu-list").removeClass("active"),b.addClass("active"),$("html, body").animate({scrollTop:$(d).offset().top-20},500)})}}}]).directive("escapeSearch",[function(){return{restrict:"A",link:function(a,b,c){$(document).keyup(function(b){27==b.keyCode&&(a.query="",a.$digest())})}}}]);